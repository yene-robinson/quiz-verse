import { renderHook, act } from '@testing-library/react';\nimport { useLoading } from '../useLoading';\nimport { useStore } from '@/store';\n\n// Mock the store\njest.mock('@/store', () => ({\n  useStore: jest.fn(),\n}));\n\nconst mockUseStore = useStore as jest.MockedFunction<typeof useStore>;\n\ndescribe('useLoading', () => {\n  const mockSetGlobalLoading = jest.fn();\n  const mockSetComponentLoading = jest.fn();\n  const mockClearComponentLoading = jest.fn();\n  const mockClearAllLoading = jest.fn();\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n    mockUseStore.mockReturnValue({\n      globalLoading: { isLoading: false },\n      componentLoading: {},\n      setGlobalLoading: mockSetGlobalLoading,\n      setComponentLoading: mockSetComponentLoading,\n      clearComponentLoading: mockClearComponentLoading,\n      clearAllLoading: mockClearAllLoading,\n    } as any);\n  });\n\n  it('returns default loading state', () => {\n    const { result } = renderHook(() => useLoading());\n    \n    expect(result.current.isLoading).toBe(false);\n    expect(result.current.message).toBeUndefined();\n    expect(result.current.progress).toBeUndefined();\n  });\n\n  it('sets global loading state when global option is true', () => {\n    const { result } = renderHook(() => useLoading({ global: true }));\n    \n    act(() => {\n      result.current.setLoading(true, 'Loading...', 50);\n    });\n    \n    expect(mockSetGlobalLoading).toHaveBeenCalledWith({\n      isLoading: true,\n      message: 'Loading...',\n      progress: 50,\n    });\n  });\n\n  it('sets component loading state when component is specified', () => {\n    const component = 'test-component';\n    const { result } = renderHook(() => useLoading({ component }));\n    \n    act(() => {\n      result.current.setLoading(true, 'Loading component...', 25);\n    });\n    \n    expect(mockSetComponentLoading).toHaveBeenCalledWith(component, {\n      isLoading: true,\n      message: 'Loading component...',\n      progress: 25,\n    });\n  });\n\n  it('clears global loading state', () => {\n    const { result } = renderHook(() => useLoading({ global: true }));\n    \n    act(() => {\n      result.current.clearLoading();\n    });\n    \n    expect(mockSetGlobalLoading).toHaveBeenCalledWith({ isLoading: false });\n  });\n\n  it('clears component loading state', () => {\n    const component = 'test-component';\n    const { result } = renderHook(() => useLoading({ component }));\n    \n    act(() => {\n      result.current.clearLoading();\n    });\n    \n    expect(mockClearComponentLoading).toHaveBeenCalledWith(component);\n  });\n\n  it('updates progress', () => {\n    const component = 'test-component';\n    mockUseStore.mockReturnValue({\n      globalLoading: { isLoading: false },\n      componentLoading: {\n        [component]: { isLoading: true, message: 'Loading...' },\n      },\n      setGlobalLoading: mockSetGlobalLoading,\n      setComponentLoading: mockSetComponentLoading,\n      clearComponentLoading: mockClearComponentLoading,\n      clearAllLoading: mockClearAllLoading,\n    } as any);\n\n    const { result } = renderHook(() => useLoading({ component }));\n    \n    act(() => {\n      result.current.updateProgress(75, 'Almost done...');\n    });\n    \n    expect(mockSetComponentLoading).toHaveBeenCalledWith(component, {\n      isLoading: true,\n      message: 'Almost done...',\n      progress: 75,\n    });\n  });\n\n  it('updates message', () => {\n    const component = 'test-component';\n    mockUseStore.mockReturnValue({\n      globalLoading: { isLoading: false },\n      componentLoading: {\n        [component]: { isLoading: true, progress: 50 },\n      },\n      setGlobalLoading: mockSetGlobalLoading,\n      setComponentLoading: mockSetComponentLoading,\n      clearComponentLoading: mockClearComponentLoading,\n      clearAllLoading: mockClearAllLoading,\n    } as any);\n\n    const { result } = renderHook(() => useLoading({ component }));\n    \n    act(() => {\n      result.current.updateMessage('New message');\n    });\n    \n    expect(mockSetComponentLoading).toHaveBeenCalledWith(component, {\n      isLoading: true,\n      message: 'New message',\n      progress: 50,\n    });\n  });\n\n  it('clears all loading states', () => {\n    const { result } = renderHook(() => useLoading());\n    \n    act(() => {\n      result.current.clearAllLoading();\n    });\n    \n    expect(mockClearAllLoading).toHaveBeenCalled();\n  });\n});